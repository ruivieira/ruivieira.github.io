<!doctype html><html lang=en-uk><head><script data-goatcounter=https://ruivieira-dev.goatcounter.com/count async src=//gc.zgo.at/count.js></script><script src=https://unpkg.com/@alpinejs/intersect@3.x.x/dist/cdn.min.js></script><script src=https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js></script><script type=module src=https://ruivieira.dev/js/deeplinks/deeplinks.js></script><link rel=preload href=https://ruivieira.dev/lib/fonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=https://ruivieira.dev/lib/fonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=https://ruivieira.dev/lib/fonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=https://ruivieira.dev/fonts/firacode/FiraCode-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=https://ruivieira.dev/fonts/vollkorn/Vollkorn-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=stylesheet href=https://ruivieira.dev/css/kbd.css type=text/css><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>Containerised Streaming Data Generation using State-Space Models Â· Rui Vieira</title>
<link rel=canonical href=https://ruivieira.dev/containerised-streaming-data-generation-using-state-space-models.html><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:title" content="Containerised Streaming Data Generation using State-Space Models"><meta property="og:description" content="To prototype and test almost any application some type of input data is needed. Getting the right data can be difficult for several reasons, including strict licenses, a considerable amount of data engineering to shape the data to our requirements and the setup of dedicated data producers. Additionally, in modern applications, we are often interested in realtime/streaming and distributed processing of data with platforms such as Apache Kafka and Apache Spark and deployment in a cloud environment like OpenShift1 with tools such as oshinko."><meta property="og:type" content="article"><meta property="og:url" content="https://ruivieira.dev/containerised-streaming-data-generation-using-state-space-models.html"><meta property="article:section" content="posts"><meta property="article:modified_time" content="2024-01-28T14:51:25+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Containerised Streaming Data Generation using State-Space Models"><meta name=twitter:description content="To prototype and test almost any application some type of input data is needed. Getting the right data can be difficult for several reasons, including strict licenses, a considerable amount of data engineering to shape the data to our requirements and the setup of dedicated data producers. Additionally, in modern applications, we are often interested in realtime/streaming and distributed processing of data with platforms such as Apache Kafka and Apache Spark and deployment in a cloud environment like OpenShift1 with tools such as oshinko."><link rel=stylesheet href=https://ruivieira.dev/css/styles.css><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://ruivieira.dev/images/favicon.ico></head><body class="max-width mx-auto px3 ltr" x-data="{currentHeading: undefined}"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-eye fa-lg"></i></a>
<a id=menu-icon-tablet href=#><i class="fas fa-eye fa-lg"></i></a>
<a id=top-icon-tablet href=# onclick='$("html, body").animate({scrollTop:0},"fast")' style=display:none aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
<span id=menu><span id=nav><ul><li><a href=https://ruivieira.dev/>Home</a></li><li><a href=https://ruivieira.dev/blog/>Blog</a></li><li><a href=https://ruivieira.dev/draw/>Drawings</a></li><li><a href=https://ruivieira.dev/map/>All pages</a></li><li><a href=https://ruivieira.dev/search.html>Search</a></li></ul></span><br><div id=share style=display:none></div><div id=toc><h4>Contents</h4><nav id=TableOfContents><ul><li><a href=#state-space-models :class="{'toc-h2':true, 'toc-highlight': currentHeading == '#state-space-models' }">State-space models</a></li><li><a href=#structure :class="{'toc-h2':true, 'toc-highlight': currentHeading == '#structure' }">Structure</a></li><li><a href=#mean :class="{'toc-h3':true, 'toc-highlight': currentHeading == '#mean' }">Mean</a></li><li><a href=#seasonality :class="{'toc-h3':true, 'toc-highlight': currentHeading == '#seasonality' }">Seasonality</a></li><li><a href=#ar-p :class="{'toc-h3':true, 'toc-highlight': currentHeading == '#ar-p' }">AR-p</a></li><li><a href=#composing :class="{'toc-h3':true, 'toc-highlight': currentHeading == '#composing' }">Composing</a></li><li><a href=#observations :class="{'toc-h2':true, 'toc-highlight': currentHeading == '#observations' }">Observations</a></li><li><a href=#continuous :class="{'toc-h3':true, 'toc-highlight': currentHeading == '#continuous' }">Continuous</a></li><li><a href=#discrete :class="{'toc-h3':true, 'toc-highlight': currentHeading == '#discrete' }">Discrete</a></li><li><a href=#categorical :class="{'toc-h3':true, 'toc-highlight': currentHeading == '#categorical' }">Categorical</a></li><li><a href=#composite-model :class="{'toc-h2':true, 'toc-highlight': currentHeading == '#composite-model' }">Composite model</a></li><li><a href=#examples :class="{'toc-h3':true, 'toc-highlight': currentHeading == '#examples' }">Examples</a></li><li><a href=#setting-up-the-generator :class="{'toc-h2':true, 'toc-highlight': currentHeading == '#setting-up-the-generator' }">Setting up the generator</a></li></ul></nav></ul></nav></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">Containerised Streaming Data Generation using State-Space Models</h1><div class=meta><div class=postdate>Updated <time datetime="2024-01-28 14:51:25 +0000 GMT" itemprop=datePublished>2024-01-28</time>
<span class=commit-hash>(<a href=https://ruivieira.dev/log/index.html#0c79fa3>0c79fa3</a>)</span></div></div></header><div class=content itemprop=articleBody><p>To prototype and test almost any application some type of input data is needed. Getting the right data can be difficult for several reasons, including strict licenses, a considerable amount of data engineering to shape the data to our requirements and the setup of dedicated data producers. Additionally, in modern applications, we are often interested in realtime/streaming and distributed processing of data with platforms such as <a href=https://kafka.apache.org/>Apache Kafka</a> and <a href=https://spark.apache.org/>Apache Spark</a> and deployment in a cloud environment like <a href=https://ruivieira.dev/openshift.html>OpenShift</a><sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> with tools such as <a href=https://radanalytics.io/>oshinko</a>.</p><p>Simulating data is not trivial, since we might want to capture complex characteristic to evaluate our algorithms in conditions similar to the real world.
In this post I&rsquo;ll introduce a tool, <a href=https://github.com/ruivieira/timeseries-mock>timeseries-mock</a>, which allows for a simple, containerised deployment of a data simulator along with some of the theory behind the data generation.</p><h2 id=state-space-models x-intersect="currentHeading = '#state-space-models'">State-space models</h2><p>A common way of modelling these patterns is to use state-space models (SSM). SSMs can be divided into a model and a observation structure.</p><p>$$
Y_t|\theta_t,\Phi \sim f\left(y_t|\theta_t,\Phi_t\right) \
\theta_t|\theta_{t-1},\Phi_t \sim g\left(\theta_t|\theta_{t-1},\Phi_t\right).
$$</p><figure><img src=https://ruivieira.dev/Excalidraw/SSM.excalidraw.svg alt=SSM.excalidraw.svg loading=lazy></figure><p>It is clear from the above that the state possesses a Markovian nature. The state at time $t$, $\theta_t$ will on depend on the previous value, $\theta_{t-1}$ and an observation at time $t$, $y_t$ will only depend on the current state, $\theta_t$, that is:</p><p>$$
p\left(\theta_{t}|\theta_{0:t-1},y_{0:t-1}\right)=p\left(\theta_{t}|\theta_{t-1}\right) \
p\left(\theta_{t-1}|\theta_{t:T},y_{t:T}\right)=p\left(\theta_{t-1}|\theta_{t}\right) \
p\left(y_{t}|\theta_{0:t},y_{0:t-1}\right)=p\left(y_{t}|\theta_{t}\right).
$$</p><p>In this post we will focus on a specific instance of SSMs, namely Dynamic Generalised Linear Models (DGLMs). If you want a deeper theoretical analysis of DGLMs I strongly recommend Mike West and Jeff Harrison&rsquo;s &ldquo;<a href=https://www.springer.com/gb/book/9780387947259>Bayesian Forecasting and Dynamic Models</a>&rdquo; (1997).
In DGLMs, the observation follows a distribution from the exponential family, $E\left(\cdot\right)$ such, that</p><p>$$
Y_t|\theta_t,\Phi \sim E\left(\eta_t,\Phi\right) \
\eta_t|\theta_t = L\left(\mathsf{F}^T \theta_t\right)
$$</p><p>where $L\left(\cdot\right)$ is the linear predictor and the state evolves according to a multivariate normal (MVN) distribution:</p><p>$$
\theta_t \sim \mathcal{N}\left(\theta_t;\mathsf{G}\theta_{t-1},\mathsf{W}\right)
$$</p><h2 id=structure x-intersect="currentHeading = '#structure'">Structure</h2><p>The fundamental way in which <code>timeseries-mock</code> works is by specifying the underlying structure and observational model in a YAML configuration file. In the following sections we will look at the options available in terms of structural and observational components and look at how to represent them. As we&rsquo;ve seen from (5), the structure will allows us to define the underlying patterns of the state evolution $\lbrace \theta_1, \theta_2, \dots, \theta_t\rbrace$. One of the advantages of DGLMs is the ability to compose several simpler components into a single complex structure. We will then look at some of these &ldquo;fundamental&rdquo; components.</p><h3 id=mean x-intersect="currentHeading = '#mean'">Mean</h3><p>An underlying mean component will represent a <a href=https://ruivieira.dev/random-walk.html>random walk</a> scalar state which can be specified in the configuration file by</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:navy>structure</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span>- <span style=color:navy>type</span>:<span style=color:#bbb> </span>mean<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:navy>start</span>:<span style=color:#bbb> </span><span style=color:#099>0.0</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:navy>noise</span>:<span style=color:#bbb> </span><span style=color:#099>1.5</span><span style=color:#bbb>
</span></span></span></code></pre></div><p>In this case <code>start</code> will correspond the mean of the state prior, $m_0$, and <code>noise</code> will correspond to the prior&rsquo;s variance, $\tau^2$, that is</p><p>$$
\theta_0 \sim \mathcal{N}\left(m_0, \tau^2\right).
$$</p><p>In the figure below we can see the above configuration for, respectively, a higher and lower value of <code>noise</code>.</p><figure><img src=https://ruivieira.dev/pages/site/images/ssm/lc.png alt=lc.png loading=lazy></figure><h3 id=seasonality x-intersect="currentHeading = '#seasonality'">Seasonality</h3><p>Seasonality is represented by Fourier components. A Fourier component can be completely specified by providing the <code>period</code>, <code>start</code>, <code>noise</code> and <code>harmonics</code>.
The <code>start</code> and <code>noise</code> parameters are analogous to the mean components we saw previously.
The <code>period</code> parameter refers to how long does it take for the cyclical pattern to repeat. This is done relatively to your time-point interval, such that</p><p>$$
P = p_{\text{fourier}}\times p_{\text{stream}}.
$$</p><p>That is, if your stream&rsquo;s rate is one observation every 100 milliseconds, $p_{\text{stream}}=0.1$, and the harmonic&rsquo;s period is 2000, $p_{\text{fourier}}=1000$, then the seasonal component will repeat every $200$ seconds. The configuration example</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:navy>structure</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span>- <span style=color:navy>type</span>:<span style=color:#bbb> </span>season<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:navy>period</span>:<span style=color:#bbb> </span><span style=color:#099>200</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:navy>harmonics</span>:<span style=color:#bbb> </span><span style=color:#099>5</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:navy>start</span>:<span style=color:#bbb> </span><span style=color:#099>0.0</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:navy>noise</span>:<span style=color:#bbb> </span><span style=color:#099>0.7</span><span style=color:#bbb>
</span></span></span></code></pre></div><p>will create a sequence of state vectors $\boldsymbol{\theta}_{0:T}$ with five components, such that:</p><p>$$
\boldsymbol{\theta}<em>t = \lbrace\theta</em>{1,t},\dots,\theta_{5,t}\rbrace.
$$</p><p>In this example, <code>period</code> refers to the number of time-points for each cycle&rsquo;s repetition and <code>harmonics</code> to the number of Fourier harmonics used. &ldquo;Simpler&rdquo; cyclic patterns usually require less harmonics. In the figure below we show on the lowest and highest frequency harmonics, on the left and right respectively.</p><figure><img src=https://ruivieira.dev/pages/site/images/ssm/fourier.png alt=fourier.png loading=lazy></figure><h3 id=ar-p x-intersect="currentHeading = '#ar-p'">AR-<em>p</em></h3><p>An AR($p$) (Auto-Regressive) component can be specified using the directives:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:navy>structure</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span>- <span style=color:navy>type</span>:<span style=color:#bbb> </span>arma<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:navy>start</span>:<span style=color:#bbb> </span><span style=color:#099>0.0</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:navy>coefficients</span>:<span style=color:#bbb> </span><span style=color:#099>0.1</span>,<span style=color:#099>0.3</span>,<span style=color:#099>0.15</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:navy>noise</span>:<span style=color:#bbb> </span><span style=color:#099>0.5</span><span style=color:#bbb>
</span></span></span></code></pre></div><p>In the above example we would be creating an AR(3) component, with respective coefficients $\phi=\lbrace 0.1,0.3,0.15 \rbrace$. These coefficients will take part of the state model as</p><p>$$
\mathsf{G} = \begin{bmatrix}
\phi_1 & \phi_2 & \dots & \phi_{p-1} & \phi_p \
1 & 0 & \dots & 0 & 0 \
\vdots & & \ddots & \vdots & \vdots \
0 & \dots & 0 & 1 & 0
\end{bmatrix}
$$</p><p>In the following plots we show respectively the first and second component of the AR(3) state vector.</p><figure><img src=https://ruivieira.dev/pages/site/images/ssm/arma3.png alt=arma3.png loading=lazy></figure><h3 id=composing x-intersect="currentHeading = '#composing'">Composing</h3><p>Structural composition of DGLM structures amounts to the individual composition of the state covariance matrix and state/observational evolution matrices such that:</p><p>$$
\mathsf{F}^T = \begin{bmatrix}\mathsf{F}_1 & \mathsf{F}_2 & \dots \mathsf{F}_i\end{bmatrix}^T \\
\mathsf{G} = \text{blockdiag}\left(\mathsf{G}_1, \mathsf{G}_2, \dots, \mathsf{G}_i\right) \\
\mathsf{W} = \text{blockdiag}\left(\mathsf{W}_1, \mathsf{W}_2, \dots, \mathsf{W}_i\right)
$$</p><p>To express the composition of structures in the YAML configuration, we simply enumerate the separate components under the <code>structure</code> key. As as example, to compose the previous <code>mean</code> and <code>seasonal</code> components, we would simply write:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:navy>structure</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span>- <span style=color:navy>type</span>:<span style=color:#bbb> </span>mean<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:navy>start</span>:<span style=color:#bbb> </span><span style=color:#099>0.0</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:navy>noise</span>:<span style=color:#bbb> </span><span style=color:#099>1.5</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span>- <span style=color:navy>type</span>:<span style=color:#bbb> </span>season<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:navy>period</span>:<span style=color:#bbb> </span><span style=color:#099>200</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:navy>harmonics</span>:<span style=color:#bbb> </span><span style=color:#099>5</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:navy>start</span>:<span style=color:#bbb> </span><span style=color:#099>0.0</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:navy>noise</span>:<span style=color:#bbb> </span><span style=color:#099>0.7</span><span style=color:#bbb>
</span></span></span></code></pre></div><p>This would create a structure containing both an underlying mean <em>and</em> a seasonal component.</p><h2 id=observations x-intersect="currentHeading = '#observations'">Observations</h2><p>As we have seen from (3) that an observational model can be coupled with a structure to complete the DGLM specification. In the following sections we will look at some example observational models and in which situations they might be useful.</p><h3 id=continuous x-intersect="currentHeading = '#continuous'">Continuous</h3><p>Continuous observations are useful to model real valued data such as stock prices, temperature readings, <em>etc.</em> This can be achieved by specifying the observational component as a Gaussian distribution such that:</p><p>$$
Y_t|\Phi \sim \mathcal{N}\left(y_t|\eta_t, \mathsf{W}\right).
$$</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:navy>observations</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span>- <span style=color:navy>type</span>:<span style=color:#bbb> </span>continuous<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:navy>noise</span>:<span style=color:#bbb> </span><span style=color:#099>1.5</span><span style=color:#bbb>
</span></span></span></code></pre></div><p>The following plot shows the coupling of the structure used in the <code>mean</code> section with the continuous (example above) observational model.</p><figure><img src=https://ruivieira.dev/pages/site/images/ssm/mv_continous.png alt=continous.png loading=lazy></figure><h3 id=discrete x-intersect="currentHeading = '#discrete'">Discrete</h3><p>Discrete observations, sometimes referred as &ldquo;count data&rdquo;, can be used to model integer quantities. This can be achieved by using a Poisson distribution in the observational model, such that:</p><p>$$
Y_t|\Phi \sim \text{Po}\left(y_t|\eta_t\right)
$$</p><p>An example configuration would be:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:navy>observations</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span>- <span style=color:navy>type</span>:<span style=color:#bbb> </span>discrete<span style=color:#bbb>
</span></span></span></code></pre></div><p>In this case we will use the previous ARMA(3) structure example and couple it with a discrete observational model. The result is shown in the plot below:</p><figure><img src=https://ruivieira.dev/pages/site/images/ssm/discrete.png alt=discrete.png loading=lazy></figure><h3 id=categorical x-intersect="currentHeading = '#categorical'">Categorical</h3><p>In the categorical case, we model the observations according to a binomial distribution, such that</p><p>$$
Y_t \sim \text{Bin}\left(y_t|\eta_t,r\right),
$$</p><p>where $r$ represents the number of categories. A typical example would be the case where $r=1$ which would represent a binary outcome (0 or 1). The following configuration implements this very case:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:navy>observations</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span>- <span style=color:navy>type</span>:<span style=color:#bbb> </span>categorical<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:navy>categories</span>:<span style=color:#bbb> </span><span style=color:#099>1</span><span style=color:#bbb>
</span></span></span></code></pre></div><p>We can see in the plot below (<em>states on the left, observations on the right</em>) a realisation of this stream, when using the previous seasonal example structure.</p><figure><img src=https://ruivieira.dev/pages/site/images/ssm/categorical.png alt=categorical.png loading=lazy></figure><p>Often, when simulating a data stream, we might be interested in the category labels themselves, rather than a numerical value. The generator allows to pass directly a list of labels and output the labelled observations. Let&rsquo;s assume we wanted to generate a stream of random DNA nucleotides (C, T, A and G). The generator allows to pass the labels directly and output the direct mapping between observations and label, that is:</p><p>$$
y_t: \lbrace 0, 1, 2, 3 \rbrace \mapsto \lbrace\text{C, T, A, G}\rbrace
$$</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:navy>observations</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span>- <span style=color:navy>type</span>:<span style=color:#bbb> </span>categorical<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:navy>values</span>:<span style=color:#bbb> </span>C,T,A,G<span style=color:#bbb>
</span></span></span></code></pre></div><p>Using the same seasonal structure and observation model as above, the output would then be:</p><figure><img src=https://ruivieira.dev/pages/site/images/ssm/categorical_nucleotides.png alt=categorical_nucleotides.png loading=lazy></figure><h2 id=composite-model x-intersect="currentHeading = '#composite-model'">Composite model</h2><p>In a real-world scenario we are interested in simulating multivariate data and that comprises of different observational models. For instance, combining observation components from categorical, continuous, <em>etc.</em></p><p>The approach taken for multivariate composite models, is that the structures are composed as seen previously into a single one and the resulting state vector is then &ldquo;collapsed&rdquo; into a vector on natural parameters, $\eta_t$ which are then used to sample the individual observation components.</p><p>$$
\theta_t = \lbrace\underbrace{\theta_{1}, \theta_{2}, \theta_{3}}<em>{\eta_1}, \underbrace{\theta</em>{4}, \theta_{5}, \theta_{6}}_{\eta_2}\rbrace \
y = f(\eta_t) \
= \lbrace f_1(\eta_1), f_2(\eta_2)\rbrace
$$</p><p>The model composition can be expressed by grouping the different structures and observations under a <code>compose</code> key:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:navy>compose</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>- <span style=color:navy>structure</span>:<span style=color:#bbb>          </span><span style=color:#998;font-style:italic># component 1</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>- <span style=color:navy>type</span>:<span style=color:#bbb> </span>mean<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:navy>start</span>:<span style=color:#bbb> </span><span style=color:#099>0.0</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:navy>noise</span>:<span style=color:#bbb> </span><span style=color:#099>0.5</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>- <span style=color:navy>observations</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>- <span style=color:navy>type</span>:<span style=color:#bbb> </span>continuous<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:navy>noise</span>:<span style=color:#bbb> </span><span style=color:#099>0.5</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>- <span style=color:navy>structure</span>:<span style=color:#bbb>          </span><span style=color:#998;font-style:italic># component 2</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>- <span style=color:navy>type</span>:<span style=color:#bbb> </span>mean<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:navy>start</span>:<span style=color:#bbb> </span><span style=color:#099>5.0</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:navy>noise</span>:<span style=color:#bbb> </span><span style=color:#099>3.7</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>- <span style=color:navy>observations</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>- <span style=color:navy>type</span>:<span style=color:#bbb> </span>continuous<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:navy>noise</span>:<span style=color:#bbb> </span><span style=color:#099>1.5</span><span style=color:#bbb>
</span></span></span></code></pre></div><h3 id=examples x-intersect="currentHeading = '#examples'">Examples</h3><p>We will look at two separate examples, one that creates a stream of simulated stock prices and one that generates a fake HTTP log.
We assume we want to simulate a stream of per-day stock prices for 3 different companies, each with different characteristics. In this case, we will model the following:</p><ul><li>Company A&rsquo;s stocks start at quite a high value ($700) and are quite stable throughout time</li><li>Company B&rsquo;s stocks start slightly lower than A ($500) and are quite stable in the long run, but show heavy fluctuation from day to day</li><li>Company C&rsquo;s stocks start at $600 are very unpredictable</li></ul><p>Since we will be using per-day data we won&rsquo;t be streaming this in realtime! We can map each daily observation to a second in our stream so we will specify a <code>period=1</code>. All stocks will exhibit a small monthly effect (<code>period=30</code>), which will be indicated by a <code>noise=0.01</code> and a yearly effect (<code>period=365</code>) with a <code>noise=2.5</code>.</p><p>The resulting configuration will be:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:navy>compose</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>- <span style=color:navy>structure</span>:<span style=color:#bbb> </span><span style=color:#998;font-style:italic># company A</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>		</span>- <span style=color:navy>type</span>:<span style=color:#bbb> </span>mean<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>		</span><span style=color:navy>start</span>:<span style=color:#bbb> </span><span style=color:#099>700</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>		</span><span style=color:navy>noise</span>:<span style=color:#bbb> </span><span style=color:#099>0.01</span><span style=color:#bbb>  </span><span style=color:#998;font-style:italic># low structural variance</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>		</span>- <span style=color:navy>type</span>:<span style=color:#bbb> </span>season<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>		</span><span style=color:navy>period</span>:<span style=color:#bbb> </span><span style=color:#099>30</span><span style=color:#bbb>   </span><span style=color:#998;font-style:italic># monthly seasonality</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>		</span><span style=color:navy>noise</span>:<span style=color:#bbb> </span><span style=color:#099>0.1</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>		</span>- <span style=color:navy>type</span>:<span style=color:#bbb> </span>season<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>		</span><span style=color:navy>period</span>:<span style=color:#bbb> </span><span style=color:#099>365</span>.<span style=color:#bbb> </span><span style=color:#998;font-style:italic># yearly seasonality</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>		</span><span style=color:navy>noise</span>:<span style=color:#bbb> </span><span style=color:#099>1.7</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>- <span style=color:navy>observations</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>		</span>- <span style=color:navy>type</span>:<span style=color:#bbb> </span>continuous<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>		</span><span style=color:navy>noise</span>:<span style=color:#bbb> </span><span style=color:#099>0.05</span><span style=color:#bbb>  </span><span style=color:#998;font-style:italic># low observational variance</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>		</span>- <span style=color:navy>structure</span>:<span style=color:#bbb> </span><span style=color:#998;font-style:italic># company B</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>			</span>- <span style=color:navy>type</span>:<span style=color:#bbb> </span>mean<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>			</span><span style=color:navy>start</span>:<span style=color:#bbb> </span><span style=color:#099>500</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>			</span><span style=color:navy>noise</span>:<span style=color:#bbb> </span><span style=color:#099>0.01</span><span style=color:#bbb>  </span><span style=color:#998;font-style:italic># low structural variance</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>			</span>- <span style=color:navy>type</span>:<span style=color:#bbb> </span>season<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>			</span><span style=color:navy>period</span>:<span style=color:#bbb> </span><span style=color:#099>30</span><span style=color:#bbb>   </span><span style=color:#998;font-style:italic># monthly seasonality</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>			</span><span style=color:navy>noise</span>:<span style=color:#bbb> </span><span style=color:#099>0.7</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>			</span>- <span style=color:navy>type</span>:<span style=color:#bbb> </span>season<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>			</span><span style=color:navy>period</span>:<span style=color:#bbb> </span><span style=color:#099>365</span>.<span style=color:#bbb> </span><span style=color:#998;font-style:italic># yearly seasonality</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>			</span><span style=color:navy>noise</span>:<span style=color:#bbb> </span><span style=color:#099>3.7</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>- <span style=color:navy>observations</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>		</span>- <span style=color:navy>type</span>:<span style=color:#bbb> </span>continuous<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>		</span><span style=color:navy>noise</span>:<span style=color:#bbb> </span><span style=color:#099>3.00</span><span style=color:#bbb>  </span><span style=color:#998;font-style:italic># higher observational variance</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>		</span>- <span style=color:navy>structure</span>:<span style=color:#bbb> </span><span style=color:#998;font-style:italic># company C</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>			</span>- <span style=color:navy>type</span>:<span style=color:#bbb> </span>mean<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>			</span><span style=color:navy>start</span>:<span style=color:#bbb> </span><span style=color:#099>600</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>			</span><span style=color:navy>noise</span>:<span style=color:#bbb> </span><span style=color:#099>3.0</span><span style=color:#bbb>  </span><span style=color:#998;font-style:italic># higher structural variance</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>			</span>- <span style=color:navy>type</span>:<span style=color:#bbb> </span>season<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>			</span><span style=color:navy>period</span>:<span style=color:#bbb> </span><span style=color:#099>30</span><span style=color:#bbb>   </span><span style=color:#998;font-style:italic># monthly seasonality</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>			</span><span style=color:navy>noise</span>:<span style=color:#bbb> </span><span style=color:#099>0.1</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>			</span>- <span style=color:navy>type</span>:<span style=color:#bbb> </span>season<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>			</span><span style=color:navy>period</span>:<span style=color:#bbb> </span><span style=color:#099>365</span>.<span style=color:#bbb> </span><span style=color:#998;font-style:italic># yearly seasonality</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>			</span><span style=color:navy>noise</span>:<span style=color:#bbb> </span><span style=color:#099>0.25</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>- <span style=color:navy>observations</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>		</span>- <span style=color:navy>type</span>:<span style=color:#bbb> </span>continuous<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>		</span><span style=color:navy>noise</span>:<span style=color:#bbb> </span><span style=color:#099>4.0</span><span style=color:#bbb>  </span><span style=color:#998;font-style:italic># higher observational variance</span><span style=color:#bbb>
</span></span></span></code></pre></div><p>A realisation of this stream looks like the figure below.</p><figure><img src=https://ruivieira.dev/pages/site/images/ssm/mv_continous.png alt=mv_continous.png loading=lazy></figure><p>To generate the fake HTTP log we will make the following assumptions:</p><ul><li>We will have a request type (<code>GET</code>, <code>POST</code>, <code>PUT</code>) which will vary following a <a href=https://ruivieira.dev/random-walk.html>random walk</a></li><li>A set of visited pages which, for illustration purposes, will be limited to (<code>/site/page.htm</code>, <code>/site/index.htm</code> and <code>/internal/example.htm</code>). We also want that the URLs visited follow a seasonal pattern.</li><li>An IP address in the IPv4 format (<em>i.e.</em> <code>0-255.0-255.0-255.0-255</code>)</li></ul><p>It is clear that for all variables the appropriate observational model is the categorical one. For the request type and the visited page we can pass directly the category name in the configuration file and for the IP we simply need four categorical observations with $r=255$.</p><p>If the underlying structure is the same, a useful shortcut to specify several observation component is the <code>replicate</code> key. In this particular example to generate four <code>0-255</code> numbers with an underlying mean as the structure, we simple use:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>- <span style=color:navy>replicate</span>:<span style=color:#bbb> </span><span style=color:#099>4</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span><span style=color:navy>structure</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>- <span style=color:navy>type</span>:<span style=color:#bbb> </span>mean<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span><span style=color:navy>start</span>:<span style=color:#bbb> </span><span style=color:#099>0.0</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span><span style=color:navy>noise</span>:<span style=color:#bbb> </span><span style=color:#099>2.1</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span><span style=color:navy>observations</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span><span style=color:navy>type</span>:<span style=color:#bbb> </span>categorical<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span><span style=color:navy>categories</span>:<span style=color:#bbb> </span><span style=color:#099>255</span><span style=color:#bbb>
</span></span></span></code></pre></div><p>The full configuration for the HTTP log simulation could then be something like this:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:navy>compose</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>- <span style=color:navy>structure</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>		</span>- <span style=color:navy>type</span>:<span style=color:#bbb> </span>mean<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>		</span><span style=color:navy>start</span>:<span style=color:#bbb> </span><span style=color:#099>0.0</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>		</span><span style=color:navy>noise</span>:<span style=color:#bbb> </span><span style=color:#099>0.01</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>		</span><span style=color:navy>observations</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>		</span><span style=color:navy>type</span>:<span style=color:#bbb> </span>categorical<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>		</span><span style=color:navy>values</span>:<span style=color:#bbb> </span>GET,POST,PUT<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>- <span style=color:navy>structure</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>		</span>- <span style=color:navy>type</span>:<span style=color:#bbb> </span>mean<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>		</span><span style=color:navy>start</span>:<span style=color:#bbb> </span><span style=color:#099>0.0</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>		</span><span style=color:navy>noise</span>:<span style=color:#bbb> </span><span style=color:#099>0.01</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>		</span>- <span style=color:navy>type</span>:<span style=color:#bbb> </span>season<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>		</span><span style=color:navy>start</span>:<span style=color:#bbb> </span><span style=color:#099>1.0</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>		</span><span style=color:navy>period</span>:<span style=color:#bbb> </span><span style=color:#099>15</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>		</span><span style=color:navy>noise</span>:<span style=color:#bbb> </span><span style=color:#099>0.2</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:navy>observations</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span><span style=color:navy>type</span>:<span style=color:#bbb> </span>categorical<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span><span style=color:navy>values</span>:<span style=color:#bbb> </span>/site/page.htm,/site/index.htm,/internal/example.htm<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span>- <span style=color:navy>replicate</span>:<span style=color:#bbb> </span><span style=color:#099>4</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span><span style=color:navy>structure</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>		</span>- <span style=color:navy>type</span>:<span style=color:#bbb> </span>mean<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>		</span><span style=color:navy>start</span>:<span style=color:#bbb> </span><span style=color:#099>0.0</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>		</span><span style=color:navy>noise</span>:<span style=color:#bbb> </span><span style=color:#099>2.1</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:navy>observations</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span><span style=color:navy>type</span>:<span style=color:#bbb> </span>categorical<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span><span style=color:navy>categories</span>:<span style=color:#bbb> </span><span style=color:#099>255</span><span style=color:#bbb>
</span></span></span></code></pre></div><pre tabindex=0><code>[&#34;PUT&#34;, &#34;/internal/example.htm&#34;, 171, 158, 59, 89]
[&#34;GET&#34;, &#34;/internal/example.htm&#34;, 171, 253, 71, 146]
[&#34;PUT&#34;, &#34;/internal/example.htm&#34;, 224, 252, 9, 156]
[&#34;POST&#34;, &#34;/site/index.htm&#34;, 143, 253, 6, 126]
[&#34;POST&#34;, &#34;/site/page.htm&#34;, 238, 254, 2, 48]
[&#34;GET&#34;, &#34;/site/page.htm&#34;, 228, 252, 52, 126]
[&#34;POST&#34;, &#34;/internal/example.htm&#34;, 229, 234, 103, 233]
[&#34;GET&#34;, &#34;/internal/example.htm&#34;, 185, 221, 109, 195]
...
</code></pre><h2 id=setting-up-the-generator x-intersect="currentHeading = '#setting-up-the-generator'">Setting up the generator</h2><p>As I have mentioned in the beginning of this post, we want to fit the data simulation solution into a cloud computing workflow. To illustrate this we will use the <a href=https://ruivieira.dev/openshift.html>OpenShift</a> platform which allows for the deployment of containerised applications. A typical setup for a streaming data processing application would be as illustrated in the figure below.
We have several sources connected to a message broker, such as Apache Kafka in this case. Data might be partitioned into &ldquo;topics&rdquo; which are then consumed by different applications, each performing data processing, either independently or in a distributed manner.</p><figure><img src=https://ruivieira.dev/Excalidraw/SSM%20Kafka.excalidraw.svg alt="SSM Kafka.excalidraw.svg" loading=lazy></figure><p>An advantage of ~timeseries-mock~ would then be to replace the &ldquo;real&rdquo; data sources with a highly configurable simulator either for the prototyping or initial testing phase. If we consider our previous example of the &ldquo;fake&rdquo; HTTP log generation, an application for Web log analytics could be prototyped and tested with simulated log data very quickly, without being blocked by the lack of suitable real data.
Since the data is consumed by proxy via the message broker&rsquo;s topics, we could later on replace the simulator with real data sources seamlessly without an impact on any of the applications.
To setup the generator (and assuming Kafka and your consumer application are already running on OpenShift) we only need to perform two steps:</p><ul><li>Write the data specifications in a YAML configuration</li><li>Use the <code>s2i</code> to deploy the simulator</li></ul><p>The <code>s2i</code> functionality of OpenShift <a href=https://github.com/openshift/source-to-image>allows to create</a> deployment ready images by simply pointing to a source code location. In this case we could simply write:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ oc new-app centos/python-36-centos7~https://github.com/ruivieira/timeseries-mock <span style=color:#b84>\
</span></span></span><span style=display:flex><span><span style=color:#b84></span>-e <span style=color:teal>KAFKA_BROKERS</span><span style=font-weight:700>=</span>kafka:9092 <span style=color:#b84>\
</span></span></span><span style=display:flex><span><span style=color:#b84></span>-e <span style=color:teal>KAFKA_TOPIC</span><span style=font-weight:700>=</span>example <span style=color:#b84>\
</span></span></span><span style=display:flex><span><span style=color:#b84></span>-e <span style=color:teal>CONF</span><span style=font-weight:700>=</span>examples/mean_continuous.yml <span style=color:#b84>\
</span></span></span><span style=display:flex><span><span style=color:#b84></span>--name<span style=font-weight:700>=</span>emitter
</span></span></code></pre></div><p>In this case, we would deploy a simulator generating data according to the specifications in <code>mean_continuous.yml</code>. This data will be sent to the topic <code>example</code> of a Kafka broker running on port <code>9092</code>.</p><figure><img src=https://ruivieira.dev/Excalidraw/SSM%20Kafka%202.excalidraw.svg alt="SSM Kafka 2.excalidraw.svg" loading=lazy></figure><p>The stream will be ready to consume and message payload will a stream of serialised JSON strings. In the case of the simulated HTTP log this would be:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>name:</span> <span style=color:navy>&#34;HTTP log&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a61717;background-color:#e3d2d2>values</span>: [<span style=color:#b84>&#34;GET&#34;</span>, <span style=color:#b84>&#34;/internal/example.htm&#34;</span>, <span style=color:#099>185</span>, <span style=color:#099>221</span>, <span style=color:#099>109</span>, <span style=color:#099>195</span>]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ul><li><code>name</code> - the name given to this stream in the configuration file</li><li><code>values</code> - a single observation for this stream</li></ul><p>After consuming the data it is straight-forward to do any post-processing if needed. For instance, the <code>values</code> above could be easily transformed into a standard Apache Web server log line.</p><p>I hope you found this tool useful, simple to use and configure. Some future work includes adding more observations distributions beyond the exponential family and the ability to directly add transformation rules to the generated observations.
If you have any suggestions, use cases (or found an issue!), please let me know in the <a href=https://github.com/ruivieira/timeseries-mock>repository</a>.</p><p>If you have any comments please let me know on <a href=https://mastodon.social/@ruivieira>Mastodon</a> (or <a href=https://twitter.com/ruimvieira>Twitter</a>).</p><p>Happy coding!</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://www.openshift.com/>https://www.openshift.com/</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div></article><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=https://ruivieira.dev/>Home</a></li><li><a href=https://ruivieira.dev/blog/>Blog</a></li><li><a href=https://ruivieira.dev/draw/>Drawings</a></li><li><a href=https://ruivieira.dev/map/>All pages</a></li><li><a href=https://ruivieira.dev/search.html>Search</a></li></ul></div><div id=toc-footer style=display:none><nav id=TableOfContents><ul><li><a href=#state-space-models>State-space models</a></li><li><a href=#structure>Structure</a><ul><li><a href=#mean>Mean</a></li><li><a href=#seasonality>Seasonality</a></li><li><a href=#ar-p>AR-<em>p</em></a></li><li><a href=#composing>Composing</a></li></ul></li><li><a href=#observations>Observations</a><ul><li><a href=#continuous>Continuous</a></li><li><a href=#discrete>Discrete</a></li><li><a href=#categorical>Categorical</a></li></ul></li><li><a href=#composite-model>Composite model</a><ul><li><a href=#examples>Examples</a></li></ul></li><li><a href=#setting-up-the-generator>Setting up the generator</a></li></ul></nav></div><div id=share-footer style=display:none></div><div id=actions-footer><a id=menu-toggle class=icon href=# onclick='return $("#nav-footer").toggle(),!1' aria-label=Menu><i class="fas fa-bars fa-lg" aria-hidden=true></i> Menu</a>
<a id=toc-toggle class=icon href=# onclick='return $("#toc-footer").toggle(),!1' aria-label=TOC><i class="fas fa-list fa-lg" aria-hidden=true></i> TOC</a>
<a id=share-toggle class=icon href=# onclick='return $("#share-footer").toggle(),!1' aria-label=Share><i class="fas fa-share-alt fa-lg" aria-hidden=true></i> share</a>
<a id=top style=display:none class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i> Top</a></div></div></div><footer id=footer><div class=footer-left>Copyright &copy; 2024 Rui Vieira</div><div class=footer-right><nav><ul><li><a href=https://ruivieira.dev/>Home</a></li><li><a href=https://ruivieira.dev/blog/>Blog</a></li><li><a href=https://ruivieira.dev/draw/>Drawings</a></li><li><a href=https://ruivieira.dev/map/>All pages</a></li><li><a href=https://ruivieira.dev/search.html>Search</a></li></ul></nav></div></footer></div></body><link rel=stylesheet href=https://ruivieira.dev/css/fa.min.css><script src=https://ruivieira.dev/js/jquery-3.6.0.min.js></script><script src=https://ruivieira.dev/js/mark.min.js></script><script src=https://ruivieira.dev/js/main.js></script><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]]},svg:{fontCache:"global"}}</script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></html>