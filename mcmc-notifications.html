<!doctype html><html lang=en-uk><head><script data-goatcounter=https://ruivieira-dev.goatcounter.com/count async src=//gc.zgo.at/count.js></script>
<script src=https://unpkg.com/@alpinejs/intersect@3.x.x/dist/cdn.min.js></script>
<script src=https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js></script>
<script type=module src=/js/deeplinks/deeplinks.js></script>
<link rel=preload href=/lib/fonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/fonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/fonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/fonts/firacode/FiraCode-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/fonts/prociono/Prociono-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=stylesheet href=/css/kbd.css type=text/css><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>MCMC notifications · Rui Vieira</title><link rel=canonical href=/mcmc-notifications.html><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:title" content="MCMC notifications"><meta property="og:description" content="It is said that patience is a virtue but the truth is that no one likes waiting (especially waiting around: this interesting article explores why people prefer walking 8 minutes to the airport’s baggage claim and having the bags ready rather than waiting the same amount of time entirely in the claim area).
Anyone performing computationally heavy work, such as Monte Carlo methods, will know that these are usually computationally expensive algorithms which, even in modern hardware, can result in waiting times in the magnitude of hours, days and even weeks."><meta property="og:type" content="article"><meta property="og:url" content="/mcmc-notifications.html"><meta property="article:section" content="posts"><meta property="article:modified_time" content="2023-01-15T15:53:40+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="MCMC notifications"><meta name=twitter:description content="It is said that patience is a virtue but the truth is that no one likes waiting (especially waiting around: this interesting article explores why people prefer walking 8 minutes to the airport’s baggage claim and having the bags ready rather than waiting the same amount of time entirely in the claim area).
Anyone performing computationally heavy work, such as Monte Carlo methods, will know that these are usually computationally expensive algorithms which, even in modern hardware, can result in waiting times in the magnitude of hours, days and even weeks."><link rel=stylesheet href=/css/styles.css><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script>
<script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=images/favicon.ico></head><body class="max-width mx-auto px3 ltr" x-data="{currentHeading: undefined}"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-eye fa-lg"></i></a>
<a id=menu-icon-tablet href=#><i class="fas fa-eye fa-lg"></i></a>
<a id=top-icon-tablet href=# onclick='$("html, body").animate({scrollTop:0},"fast")' style=display:none aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
<span id=menu><span id=nav><ul><li><a href=/>Home</a></li><li><a href=/map/>All pages</a></li><li><a href=/search.html>Search</a></li></ul></span><br><div id=share style=display:none></div><div id=toc><h4>Contents</h4><nav id=TableOfContents><ul></ul></nav></ul></nav></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">MCMC notifications</h1><div class=meta><div class=postdate>Updated <time datetime="2023-01-15 15:53:40 +0000 GMT" itemprop=datePublished>2023-01-15</time>
<span class=commit-hash>(<a href=/log/index.html#fe73f60>fe73f60</a>)</span></div></div></header><div class=content itemprop=articleBody><p>It is said that patience is a virtue but the truth is that no one likes waiting (especially <em>waiting around</em>: <a href="http://www.nytimes.com/2012/08/19/opinion/sunday/why-waiting-in-line-is-torture.html?_r=0">this interesting article</a> explores why people prefer walking 8 minutes to the airport’s baggage claim and having the bags ready rather than waiting the same amount of time entirely in the claim area).</p><p>Anyone performing computationally heavy work, such as Monte Carlo methods, will know that these are usually computationally expensive algorithms which, even in modern hardware, can result in waiting times in the magnitude of hours, days and even weeks.</p><p>These long running times coupled with the fact that in certain cases it is not easy to accurately predict how long a certain number of iterations will take, usually leads to a tiresome behaviour of constantly checking for good (or bad) news.</p><p>Although it is perfectly possible to specify that your simulation should stop after a certain amount of time (especially valid for very long simulations), this doesn’t seem to be the standard practice.</p><p>In this post I’ll detail my current setup for being notified <em>exactly</em> of when simulations are finished. To implement this setup, the following stack is required:</p><ul><li>A <a href=http://openjdk.java.net>JDK</a></li><li><a href=/maven.html>Apache Maven</a><sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></li><li>A messaging service <a href=https://www.pushbullet.com>Pushbullet</a></li><li>A smartphone, tablet, smartwatch (or any other internet enabled device)</li></ul><p>To start, we can create an account in Pushbullet, which will involve, in the simplest case, signing up using some authentication service such as Google.</p><p>Next, we will install the client application (available for <a href="https://play.google.com/store/apps/details?id=com.pushbullet.android&amp;hl=en_GB">Android</a>, <a href=https://itunes.apple.com/gb/app/pushbullet/id810352052>iOS</a> and <a href=https://www.pushbullet.com/apps>most modern browsers</a> after which we can enable notifications (at least in the Android client, I’m not familiar with the iPhone version).</p><p>Since my current work started as a plain Java project which in time evolved mainly to <a href=/scala.html>Scala</a>, it consists of an unholy mixture of Maven as a build tool for Scala code.</p><p>This shouldn&rsquo;t be a problem for other setups, but I’ll just go through my specific setup (<em>i.e.</em> using Maven dependencies to a Scala project).</p><p>To implement communication between the code and the messaging service, we can use a simple library such as <a href=https://github.com/silk8192/jpushbullet>jpushbullet</a>.</p><p>The library works well enough, although at the time of writing it only supports Pushbullet’s v1 API but not the <a href=https://docs.pushbullet.com/#api>newer v2 API</a>.</p><p>Since the project, unfortunately, is not in Maven central, you should build it from scratch. Fortunately, in a sensibly configured machine, this is trivial.</p><p>In the machine where you plan to perform the simulations, clone and build <code>jpushbullet</code>.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git clone git@github.com:silk8192/jpushbullet.git
</span></span><span style=display:flex><span>$ mvn clean install
</span></span></code></pre></div><p>Once the build is complete, you can add it as a local dependency in your project’s <code>pom.xml</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:navy>&lt;dependencies&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:navy>&lt;dependency&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:navy>&lt;groupId&gt;</span>com.shakethat.jpushbullet<span style=color:navy>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:navy>&lt;artifactId&gt;</span>jpushbullet<span style=color:navy>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:navy>&lt;/dependency&gt;</span>
</span></span><span style=display:flex><span><span style=color:navy>&lt;/dependencies&gt;</span>
</span></span></code></pre></div><p>For the purpose of this example, lets assume that you have the following <code>Object</code> as the entry point of your simulation. The next step is to add a call to the Pushbullet service before the exit point. Please keep in mind that it is <em>very bad</em> practice to include your personal API key in your committed code. I <em>strongly</em> suggest you keep this information in a separate file (/e.g./ in ~resources~), read it at runtime and add it to ~.gitignore~.</p><p>That being said, place the messaging code as such:</p><p>package benchmarks
import com.shakethat.jpushbullet.PushbulletClient</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scala data-lang=scala><span style=display:flex><span><span style=font-weight:700>object</span> <span style=color:#458;font-weight:700>MCMC</span> <span style=font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=font-weight:700>def</span> main<span style=font-weight:700>(</span>args<span style=font-weight:700>:</span><span style=color:#458;font-weight:700>Array</span><span style=font-weight:700>[</span><span style=color:#458;font-weight:700>String</span><span style=font-weight:700>])</span><span style=font-weight:700>:</span><span style=color:#458;font-weight:700>Unit</span> <span style=font-weight:700>=</span> <span style=font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#998;font-style:italic>// Your MCMC code
</span></span></span><span style=display:flex><span><span style=color:#998;font-style:italic></span>		<span style=font-weight:700>val</span> client <span style=font-weight:700>=</span> <span style=font-weight:700>new</span> <span style=color:#458;font-weight:700>PushbulletClient</span><span style=font-weight:700>(</span>api\_key<span style=font-weight:700>)</span>
</span></span><span style=display:flex><span>		<span style=font-weight:700>val</span> devices <span style=font-weight:700>=</span> client<span style=font-weight:700>.</span>getDevices
</span></span><span style=display:flex><span>		<span style=font-weight:700>val</span> title <span style=font-weight:700>=</span> <span style=color:#b84>&#34;MCMC simulation finished&#34;</span>
</span></span><span style=display:flex><span>		<span style=font-weight:700>val</span> body <span style=font-weight:700>=</span> <span style=color:#b84>&#34;Some summary can be included&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#998;font-style:italic>// n is the preferred device number
</span></span></span><span style=display:flex><span><span style=color:#998;font-style:italic></span>		client<span style=font-weight:700>.</span>sendNote<span style=font-weight:700>(</span><span style=font-weight:700>true</span><span style=font-weight:700>,</span>
</span></span><span style=display:flex><span>				devices
</span></span><span style=display:flex><span>					<span style=font-weight:700>.</span>getDevices
</span></span><span style=display:flex><span>					<span style=font-weight:700>.</span>get<span style=font-weight:700>(</span>n<span style=font-weight:700>)</span>
</span></span><span style=display:flex><span>					<span style=font-weight:700>.</span>getIden<span style=font-weight:700>(),</span> title<span style=font-weight:700>,</span> body<span style=font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=font-weight:700>}</span>
</span></span></code></pre></div><p>Usually, I would call this code via ~ssh~ into my main machine from Maven (using <a href=http://scala-tools.org/mvnsites/maven-scala-plugin/>Scala Maven</a>) as:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ nohup mvn scala:run -DmainClass<span style=font-weight:700>=</span>benchmarks.MCMC &amp;
</span></span></code></pre></div><p>Finally, when the simulation is completed, you will be notified in the client devices (you can select which ones by issuing separate <code>sendNote</code> calls) and include a result summary, as an example.</p><figure><img src=/site/images/pushbullet.png alt=pushbullet.png></figure><p>My current setup generates an R script from a template which is run by ~Rscript~ in order to produce a PDF report. However, be careful, since file quotas in Pushbullet are limited, so text notifications should be used without worry of going over the free usage tier.</p><p>Keep in mind that there are other alternatives to <code>jpushbullet</code>, such as <a href=https://github.com/jcgay/send-notification>send-notification</a>, a general notification library for Java for which the setup is quite similar.</p><p>Hope this was helpful.</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=http://maven.apache.org>http://maven.apache.org</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div></article><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=/>Home</a></li><li><a href=/map/>All pages</a></li><li><a href=/search.html>Search</a></li></ul></div><div id=toc-footer style=display:none><nav id=TableOfContents></nav></div><div id=share-footer style=display:none></div><div id=actions-footer><a id=menu-toggle class=icon href=# onclick='return $("#nav-footer").toggle(),!1' aria-label=Menu><i class="fas fa-bars fa-lg" aria-hidden=true></i> Menu</a>
<a id=toc-toggle class=icon href=# onclick='return $("#toc-footer").toggle(),!1' aria-label=TOC><i class="fas fa-list fa-lg" aria-hidden=true></i> TOC</a>
<a id=share-toggle class=icon href=# onclick='return $("#share-footer").toggle(),!1' aria-label=Share><i class="fas fa-share-alt fa-lg" aria-hidden=true></i> share</a>
<a id=top style=display:none class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i> Top</a></div></div></div><footer id=footer><div class=footer-left>Copyright &copy; 2023 Rui Vieira</div><div class=footer-right><nav><ul><li><a href=/>Home</a></li><li><a href=/map/>All pages</a></li><li><a href=/search.html>Search</a></li></ul></nav></div></footer></div></body><link rel=stylesheet href=/css/fa.min.css><script src=/js/jquery-3.6.0.min.js></script>
<script src=/js/mark.min.js></script>
<script src=/js/main.js></script></html>