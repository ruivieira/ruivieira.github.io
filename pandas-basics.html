<!doctype html><html lang=en-uk><head><script data-goatcounter=https://ruivieira-dev.goatcounter.com/count async src=//gc.zgo.at/count.js></script><script src=https://unpkg.com/@alpinejs/intersect@3.x.x/dist/cdn.min.js></script><script src=https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js></script><script type=module src=https://ruivieira.dev/js/deeplinks/deeplinks.js></script><link rel=preload href=https://ruivieira.dev/lib/fonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=https://ruivieira.dev/lib/fonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=https://ruivieira.dev/lib/fonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=https://ruivieira.dev/fonts/firacode/FiraCode-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=https://ruivieira.dev/fonts/vollkorn/Vollkorn-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=stylesheet href=https://ruivieira.dev/css/kbd.css type=text/css><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>Pandas basics · Rui Vieira</title>
<link rel=canonical href=https://ruivieira.dev/pandas-basics.html><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:title" content="Pandas basics"><meta property="og:description" content="Creating dataframesLet&rsquo;s start with the basics. How to create a dataframe.
Loading from CSVDataframes can be created from CSV files by using the following method:
import pandas as pd pd.read_csv('../../data/mpg.csv') mpg cylinders displacement horsepower weight acceleration model_year origin name 0 18.0 8 307.0 130 3504 12.0 70 1 chevrolet chevelle malibu 1 15.0 8 350.0 165 3693 11.5 70 1 buick skylark 320 2 18.0 8 318.0 150 3436 11."><meta property="og:type" content="article"><meta property="og:url" content="https://ruivieira.dev/pandas-basics.html"><meta property="article:section" content="posts"><meta property="article:modified_time" content="2023-05-28T11:45:56+01:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Pandas basics"><meta name=twitter:description content="Creating dataframesLet&rsquo;s start with the basics. How to create a dataframe.
Loading from CSVDataframes can be created from CSV files by using the following method:
import pandas as pd pd.read_csv('../../data/mpg.csv') mpg cylinders displacement horsepower weight acceleration model_year origin name 0 18.0 8 307.0 130 3504 12.0 70 1 chevrolet chevelle malibu 1 15.0 8 350.0 165 3693 11.5 70 1 buick skylark 320 2 18.0 8 318.0 150 3436 11."><link rel=stylesheet href=https://ruivieira.dev/css/styles.css><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://ruivieira.dev/images/favicon.ico></head><body class="max-width mx-auto px3 ltr" x-data="{currentHeading: undefined}"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-eye fa-lg"></i></a>
<a id=menu-icon-tablet href=#><i class="fas fa-eye fa-lg"></i></a>
<a id=top-icon-tablet href=# onclick='$("html, body").animate({scrollTop:0},"fast")' style=display:none aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
<span id=menu><span id=nav><ul><li><a href=https://ruivieira.dev/>Home</a></li><li><a href=https://ruivieira.dev/blog/>Blog</a></li><li><a href=https://ruivieira.dev/draw/>Drawings</a></li><li><a href=https://ruivieira.dev/map/>All pages</a></li><li><a href=https://ruivieira.dev/search.html>Search</a></li></ul></span><br><div id=share style=display:none></div><div id=toc><h4>Contents</h4><nav id=TableOfContents><ul><li><a href=#creating-dataframes :class="{'toc-h2':true, 'toc-highlight': currentHeading == '#creating-dataframes' }">Creating dataframes</a></li><li><a href=#loading-from-csv :class="{'toc-h3':true, 'toc-highlight': currentHeading == '#loading-from-csv' }">Loading from CSV</a></li><li><a href=#random-dataframes :class="{'toc-h3':true, 'toc-highlight': currentHeading == '#random-dataframes' }">Random dataframes</a></li><li><a href=#concatenate-dataframes :class="{'toc-h2':true, 'toc-highlight': currentHeading == '#concatenate-dataframes' }">Concatenate dataframes</a></li><li><a href=#row-wise :class="{'toc-h3':true, 'toc-highlight': currentHeading == '#row-wise' }">Row-wise</a></li><li><a href=#column-operations :class="{'toc-h2':true, 'toc-highlight': currentHeading == '#column-operations' }">Column operations</a></li><li><a href=#check-column-existence :class="{'toc-h3':true, 'toc-highlight': currentHeading == '#check-column-existence' }">Check column existence</a></li><li><a href=#renaming-columns :class="{'toc-h3':true, 'toc-highlight': currentHeading == '#renaming-columns' }">Renaming columns</a></li><li><a href=#dropping-columns :class="{'toc-h3':true, 'toc-highlight': currentHeading == '#dropping-columns' }">Dropping columns</a></li><li><a href=#subsetting-and-indexing :class="{'toc-h2':true, 'toc-highlight': currentHeading == '#subsetting-and-indexing' }">Subsetting and indexing</a></li><li><a href=#indexing-performance :class="{'toc-h3':true, 'toc-highlight': currentHeading == '#indexing-performance' }">Indexing performance</a></li></ul></nav><h4>Related</h4><nav><ul><li class="header-post toc"><span class=backlink-count>1</span>
<a href=https://ruivieira.dev/pandas.html>Pandas</a></li></ul></nav></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">Pandas basics</h1><div class=meta><div class=postdate>Updated <time datetime="2023-05-28 11:45:56 +0100 BST" itemprop=datePublished>2023-05-28</time>
<span class=commit-hash>(<a href=https://ruivieira.dev/log/index.html#1454e0a>1454e0a</a>)</span></div></div></header><div class=content itemprop=articleBody><script src=https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin=anonymous></script><script type=application/javascript>define("jquery",[],function(){return window.jQuery})</script><h2 id=creating-dataframes x-intersect="currentHeading = '#creating-dataframes'">Creating dataframes</h2><p>Let&rsquo;s start with the basics. How to create a dataframe.</p><h3 id=loading-from-csv x-intersect="currentHeading = '#loading-from-csv'">Loading from CSV</h3><p>Dataframes can be created from CSV files by using the following method:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=font-weight:700>import</span> <span style=color:#555>pandas</span> <span style=font-weight:700>as</span> <span style=color:#555>pd</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>pd<span style=font-weight:700>.</span>read_csv(<span style=color:#b84>&#39;../../data/mpg.csv&#39;</span>)
</span></span></code></pre></div><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}<pre><code>.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</code></pre><p></style></p><table border=1 class=dataframe><thead><tr style=text-align:right><th></th><th>mpg</th><th>cylinders</th><th>displacement</th><th>horsepower</th><th>weight</th><th>acceleration</th><th>model_year</th><th>origin</th><th>name</th></tr></thead><tbody><tr><th>0</th><td>18.0</td><td>8</td><td>307.0</td><td>130</td><td>3504</td><td>12.0</td><td>70</td><td>1</td><td>chevrolet chevelle malibu</td></tr><tr><th>1</th><td>15.0</td><td>8</td><td>350.0</td><td>165</td><td>3693</td><td>11.5</td><td>70</td><td>1</td><td>buick skylark 320</td></tr><tr><th>2</th><td>18.0</td><td>8</td><td>318.0</td><td>150</td><td>3436</td><td>11.0</td><td>70</td><td>1</td><td>plymouth satellite</td></tr><tr><th>3</th><td>16.0</td><td>8</td><td>304.0</td><td>150</td><td>3433</td><td>12.0</td><td>70</td><td>1</td><td>amc rebel sst</td></tr><tr><th>4</th><td>17.0</td><td>8</td><td>302.0</td><td>140</td><td>3449</td><td>10.5</td><td>70</td><td>1</td><td>ford torino</td></tr><tr><th>...</th><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr><tr><th>393</th><td>27.0</td><td>4</td><td>140.0</td><td>86</td><td>2790</td><td>15.6</td><td>82</td><td>1</td><td>ford mustang gl</td></tr><tr><th>394</th><td>44.0</td><td>4</td><td>97.0</td><td>52</td><td>2130</td><td>24.6</td><td>82</td><td>2</td><td>vw pickup</td></tr><tr><th>395</th><td>32.0</td><td>4</td><td>135.0</td><td>84</td><td>2295</td><td>11.6</td><td>82</td><td>1</td><td>dodge rampage</td></tr><tr><th>396</th><td>28.0</td><td>4</td><td>120.0</td><td>79</td><td>2625</td><td>18.6</td><td>82</td><td>1</td><td>ford ranger</td></tr><tr><th>397</th><td>31.0</td><td>4</td><td>119.0</td><td>82</td><td>2720</td><td>19.4</td><td>82</td><td>1</td><td>chevy s-10</td></tr></tbody></table><p>398 rows × 9 columns</p></div><p>If you want to bypass the column name detection (from tcolumnsheader), you can supply the column names directly:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>columns <span style=font-weight:700>=</span> [<span style=color:#b84>f</span><span style=color:#b84>&#34;field_</span><span style=color:#b84>{</span>i<span style=color:#b84>}</span><span style=color:#b84>&#34;</span> <span style=font-weight:700>for</span> i <span style=font-weight:700>in</span> <span style=color:#999>range</span>(<span style=color:#099>9</span>)]
</span></span><span style=display:flex><span>pd<span style=font-weight:700>.</span>read_csv(<span style=color:#b84>&#39;../../data/mpg.csv&#39;</span>, names<span style=font-weight:700>=</span>columns, skiprows<span style=font-weight:700>=</span><span style=color:#099>1</span>, header<span style=font-weight:700>=</span><span style=font-weight:700>None</span>)
</span></span></code></pre></div><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}<pre><code>.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</code></pre><p></style></p><table border=1 class=dataframe><thead><tr style=text-align:right><th></th><th>field_0</th><th>field_1</th><th>field_2</th><th>field_3</th><th>field_4</th><th>field_5</th><th>field_6</th><th>field_7</th><th>field_8</th></tr></thead><tbody><tr><th>0</th><td>18.0</td><td>8</td><td>307.0</td><td>130</td><td>3504</td><td>12.0</td><td>70</td><td>1</td><td>chevrolet chevelle malibu</td></tr><tr><th>1</th><td>15.0</td><td>8</td><td>350.0</td><td>165</td><td>3693</td><td>11.5</td><td>70</td><td>1</td><td>buick skylark 320</td></tr><tr><th>2</th><td>18.0</td><td>8</td><td>318.0</td><td>150</td><td>3436</td><td>11.0</td><td>70</td><td>1</td><td>plymouth satellite</td></tr><tr><th>3</th><td>16.0</td><td>8</td><td>304.0</td><td>150</td><td>3433</td><td>12.0</td><td>70</td><td>1</td><td>amc rebel sst</td></tr><tr><th>4</th><td>17.0</td><td>8</td><td>302.0</td><td>140</td><td>3449</td><td>10.5</td><td>70</td><td>1</td><td>ford torino</td></tr><tr><th>...</th><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr><tr><th>393</th><td>27.0</td><td>4</td><td>140.0</td><td>86</td><td>2790</td><td>15.6</td><td>82</td><td>1</td><td>ford mustang gl</td></tr><tr><th>394</th><td>44.0</td><td>4</td><td>97.0</td><td>52</td><td>2130</td><td>24.6</td><td>82</td><td>2</td><td>vw pickup</td></tr><tr><th>395</th><td>32.0</td><td>4</td><td>135.0</td><td>84</td><td>2295</td><td>11.6</td><td>82</td><td>1</td><td>dodge rampage</td></tr><tr><th>396</th><td>28.0</td><td>4</td><td>120.0</td><td>79</td><td>2625</td><td>18.6</td><td>82</td><td>1</td><td>ford ranger</td></tr><tr><th>397</th><td>31.0</td><td>4</td><td>119.0</td><td>82</td><td>2720</td><td>19.4</td><td>82</td><td>1</td><td>chevy s-10</td></tr></tbody></table><p>398 rows × 9 columns</p></div><h3 id=random-dataframes x-intersect="currentHeading = '#random-dataframes'">Random dataframes</h3><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=font-weight:700>import</span> <span style=color:#555>numpy</span> <span style=font-weight:700>as</span> <span style=color:#555>np</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>N<span style=font-weight:700>=</span><span style=color:#099>100</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>df <span style=font-weight:700>=</span> pd<span style=font-weight:700>.</span>DataFrame({
</span></span><span style=display:flex><span>    <span style=color:#b84>&#39;a&#39;</span>:np<span style=font-weight:700>.</span>random<span style=font-weight:700>.</span>randn(N),
</span></span><span style=display:flex><span>    <span style=color:#b84>&#39;b&#39;</span>:np<span style=font-weight:700>.</span>random<span style=font-weight:700>.</span>choice( [<span style=color:#099>5</span>,<span style=color:#099>7</span>,np<span style=font-weight:700>.</span>nan], N),
</span></span><span style=display:flex><span>    <span style=color:#b84>&#39;c&#39;</span>:np<span style=font-weight:700>.</span>random<span style=font-weight:700>.</span>choice( [<span style=color:#b84>&#39;foo&#39;</span>,<span style=color:#b84>&#39;bar&#39;</span>,<span style=color:#b84>&#39;baz&#39;</span>], N),
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>df<span style=font-weight:700>.</span>head()
</span></span></code></pre></div><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}<pre><code>.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</code></pre><p></style></p><table border=1 class=dataframe><thead><tr style=text-align:right><th></th><th>a</th><th>b</th><th>c</th></tr></thead><tbody><tr><th>0</th><td>-1.663535</td><td>5.0</td><td>baz</td></tr><tr><th>1</th><td>0.408342</td><td>NaN</td><td>foo</td></tr><tr><th>2</th><td>0.424239</td><td>NaN</td><td>bar</td></tr><tr><th>3</th><td>1.512528</td><td>5.0</td><td>foo</td></tr><tr><th>4</th><td>-2.062024</td><td>5.0</td><td>foo</td></tr></tbody></table></div><h2 id=concatenate-dataframes x-intersect="currentHeading = '#concatenate-dataframes'">Concatenate dataframes</h2><h3 id=row-wise x-intersect="currentHeading = '#row-wise'">Row-wise</h3><p>To concatenate dataframes row-wise (<em>i.e.</em> to append more rows to dataframes with the same structure) we can use the <code>.concat()</code> method. For instance, if we create a new random dataframe:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>df_extra <span style=font-weight:700>=</span> pd<span style=font-weight:700>.</span>DataFrame({
</span></span><span style=display:flex><span>    <span style=color:#b84>&#39;a&#39;</span>:np<span style=font-weight:700>.</span>random<span style=font-weight:700>.</span>randn(N),
</span></span><span style=display:flex><span>    <span style=color:#b84>&#39;b&#39;</span>:np<span style=font-weight:700>.</span>random<span style=font-weight:700>.</span>choice( [<span style=color:#099>11</span>,<span style=color:#099>12</span>,<span style=color:#099>13</span>], N),
</span></span><span style=display:flex><span>    <span style=color:#b84>&#39;c&#39;</span>:np<span style=font-weight:700>.</span>random<span style=font-weight:700>.</span>choice( [<span style=color:#b84>&#39;zombie&#39;</span>,<span style=color:#b84>&#39;woof&#39;</span>,<span style=color:#b84>&#39;nite&#39;</span>], N),
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>df_extra<span style=font-weight:700>.</span>head()
</span></span></code></pre></div><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}<pre><code>.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</code></pre><p></style></p><table border=1 class=dataframe><thead><tr style=text-align:right><th></th><th>a</th><th>b</th><th>c</th></tr></thead><tbody><tr><th>0</th><td>-0.308607</td><td>13</td><td>nite</td></tr><tr><th>1</th><td>1.241705</td><td>11</td><td>nite</td></tr><tr><th>2</th><td>1.449900</td><td>11</td><td>zombie</td></tr><tr><th>3</th><td>0.741891</td><td>12</td><td>nite</td></tr><tr><th>4</th><td>-1.586658</td><td>12</td><td>zombie</td></tr></tbody></table></div><p>We can now concatenate an arbitray number of dataframes by passing them as a list:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>df_all <span style=font-weight:700>=</span> pd<span style=font-weight:700>.</span>concat([df, df_extra])
</span></span><span style=display:flex><span>df_all<span style=font-weight:700>.</span>sample(<span style=color:#099>9</span>)
</span></span></code></pre></div><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}<pre><code>.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</code></pre><p></style></p><table border=1 class=dataframe><thead><tr style=text-align:right><th></th><th>a</th><th>b</th><th>c</th></tr></thead><tbody><tr><th>98</th><td>-0.412014</td><td>11.0</td><td>zombie</td></tr><tr><th>38</th><td>-0.656568</td><td>5.0</td><td>foo</td></tr><tr><th>15</th><td>0.263778</td><td>13.0</td><td>zombie</td></tr><tr><th>53</th><td>-0.133630</td><td>NaN</td><td>baz</td></tr><tr><th>21</th><td>-0.106806</td><td>NaN</td><td>bar</td></tr><tr><th>34</th><td>-0.675752</td><td>7.0</td><td>foo</td></tr><tr><th>13</th><td>0.181684</td><td>12.0</td><td>zombie</td></tr><tr><th>8</th><td>-1.189809</td><td>12.0</td><td>zombie</td></tr><tr><th>0</th><td>-0.308607</td><td>13.0</td><td>nite</td></tr></tbody></table></div><h2 id=column-operations x-intersect="currentHeading = '#column-operations'">Column operations</h2><h3 id=check-column-existence x-intersect="currentHeading = '#check-column-existence'">Check column existence</h3><p>The <code>in</code> keyword can be used directly to check column existence.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#b84>&#39;b&#39;</span> <span style=font-weight:700>in</span> df
</span></span></code></pre></div><pre><code>True
</code></pre><h3 id=renaming-columns x-intersect="currentHeading = '#renaming-columns'">Renaming columns</h3><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>df<span style=font-weight:700>.</span>rename(columns<span style=font-weight:700>=</span>{<span style=color:#b84>&#34;a&#34;</span>: <span style=color:#b84>&#34;new_name&#34;</span>}, inplace<span style=font-weight:700>=</span><span style=font-weight:700>True</span>)
</span></span><span style=display:flex><span>df<span style=font-weight:700>.</span>columns
</span></span></code></pre></div><pre><code>Index(['new_name', 'b', 'c'], dtype='object')
</code></pre><p>Using a mapping function. In this case <code>str.upper()</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>df<span style=font-weight:700>.</span>rename(columns<span style=font-weight:700>=</span><span style=color:#999>str</span><span style=font-weight:700>.</span>upper, inplace<span style=font-weight:700>=</span><span style=font-weight:700>True</span>)
</span></span><span style=display:flex><span>df<span style=font-weight:700>.</span>columns
</span></span></code></pre></div><pre><code>Index(['NEW_NAME', 'B', 'C'], dtype='object')
</code></pre><p>We can also use a lambda. For instance, using <code>lambda x: x.capitalize()</code> would result:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>df<span style=font-weight:700>.</span>rename(columns<span style=font-weight:700>=</span><span style=font-weight:700>lambda</span> x: x<span style=font-weight:700>.</span>capitalize(), inplace<span style=font-weight:700>=</span><span style=font-weight:700>True</span>)
</span></span><span style=display:flex><span>df<span style=font-weight:700>.</span>columns
</span></span></code></pre></div><pre><code>Index(['New_name', 'B', 'C'], dtype='object')
</code></pre><p>A list of column names can be passed directly to columns.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>df<span style=font-weight:700>.</span>columns <span style=font-weight:700>=</span> [<span style=color:#b84>&#34;first&#34;</span>, <span style=color:#b84>&#34;second&#34;</span>, <span style=color:#b84>&#34;third&#34;</span>]
</span></span><span style=display:flex><span>df<span style=font-weight:700>.</span>columns
</span></span></code></pre></div><pre><code>Index(['first', 'second', 'third'], dtype='object')
</code></pre><h3 id=dropping-columns x-intersect="currentHeading = '#dropping-columns'">Dropping columns</h3><p>A column can be dropped using the <code>.drop()</code> method along with the <code>column</code> keyword. For instance in the dataframe <code>df</code>:
We can drop the <code>second</code> column using:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>df<span style=font-weight:700>.</span>drop(columns<span style=font-weight:700>=</span><span style=color:#b84>&#39;second&#39;</span>)
</span></span></code></pre></div><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}<pre><code>.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</code></pre><p></style></p><table border=1 class=dataframe><thead><tr style=text-align:right><th></th><th>first</th><th>third</th></tr></thead><tbody><tr><th>0</th><td>-1.663535</td><td>baz</td></tr><tr><th>1</th><td>0.408342</td><td>foo</td></tr><tr><th>2</th><td>0.424239</td><td>bar</td></tr><tr><th>3</th><td>1.512528</td><td>foo</td></tr><tr><th>4</th><td>-2.062024</td><td>foo</td></tr><tr><th>...</th><td>...</td><td>...</td></tr><tr><th>95</th><td>-0.856850</td><td>foo</td></tr><tr><th>96</th><td>0.850722</td><td>foo</td></tr><tr><th>97</th><td>-1.076690</td><td>bar</td></tr><tr><th>98</th><td>2.074288</td><td>baz</td></tr><tr><th>99</th><td>-1.176129</td><td>baz</td></tr></tbody></table><p>100 rows × 2 columns</p></div><p>The <code>del</code> keyword is also a possibility. However, <code>del</code> changes the dataframe <em>in-place</em>, therefore we will make a copy of the dataframe first.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>df_copy <span style=font-weight:700>=</span> df<span style=font-weight:700>.</span>copy()
</span></span><span style=display:flex><span>df_copy
</span></span></code></pre></div><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}<pre><code>.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</code></pre><p></style></p><table border=1 class=dataframe><thead><tr style=text-align:right><th></th><th>first</th><th>second</th><th>third</th></tr></thead><tbody><tr><th>0</th><td>-1.663535</td><td>5.0</td><td>baz</td></tr><tr><th>1</th><td>0.408342</td><td>NaN</td><td>foo</td></tr><tr><th>2</th><td>0.424239</td><td>NaN</td><td>bar</td></tr><tr><th>3</th><td>1.512528</td><td>5.0</td><td>foo</td></tr><tr><th>4</th><td>-2.062024</td><td>5.0</td><td>foo</td></tr><tr><th>...</th><td>...</td><td>...</td><td>...</td></tr><tr><th>95</th><td>-0.856850</td><td>NaN</td><td>foo</td></tr><tr><th>96</th><td>0.850722</td><td>NaN</td><td>foo</td></tr><tr><th>97</th><td>-1.076690</td><td>7.0</td><td>bar</td></tr><tr><th>98</th><td>2.074288</td><td>7.0</td><td>baz</td></tr><tr><th>99</th><td>-1.176129</td><td>7.0</td><td>baz</td></tr></tbody></table><p>100 rows × 3 columns</p></div><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=font-weight:700>del</span> df_copy[<span style=color:#b84>&#39;second&#39;</span>]
</span></span><span style=display:flex><span>df_copy
</span></span></code></pre></div><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}<pre><code>.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</code></pre><p></style></p><table border=1 class=dataframe><thead><tr style=text-align:right><th></th><th>first</th><th>third</th></tr></thead><tbody><tr><th>0</th><td>-1.663535</td><td>baz</td></tr><tr><th>1</th><td>0.408342</td><td>foo</td></tr><tr><th>2</th><td>0.424239</td><td>bar</td></tr><tr><th>3</th><td>1.512528</td><td>foo</td></tr><tr><th>4</th><td>-2.062024</td><td>foo</td></tr><tr><th>...</th><td>...</td><td>...</td></tr><tr><th>95</th><td>-0.856850</td><td>foo</td></tr><tr><th>96</th><td>0.850722</td><td>foo</td></tr><tr><th>97</th><td>-1.076690</td><td>bar</td></tr><tr><th>98</th><td>2.074288</td><td>baz</td></tr><tr><th>99</th><td>-1.176129</td><td>baz</td></tr></tbody></table><p>100 rows × 2 columns</p></div><p>Yet another possibility is to drop the column by index. For instance:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>df<span style=font-weight:700>.</span>drop(columns<span style=font-weight:700>=</span>df<span style=font-weight:700>.</span>columns[<span style=color:#099>1</span>])
</span></span></code></pre></div><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}<pre><code>.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</code></pre><p></style></p><table border=1 class=dataframe><thead><tr style=text-align:right><th></th><th>first</th><th>third</th></tr></thead><tbody><tr><th>0</th><td>-1.663535</td><td>baz</td></tr><tr><th>1</th><td>0.408342</td><td>foo</td></tr><tr><th>2</th><td>0.424239</td><td>bar</td></tr><tr><th>3</th><td>1.512528</td><td>foo</td></tr><tr><th>4</th><td>-2.062024</td><td>foo</td></tr><tr><th>...</th><td>...</td><td>...</td></tr><tr><th>95</th><td>-0.856850</td><td>foo</td></tr><tr><th>96</th><td>0.850722</td><td>foo</td></tr><tr><th>97</th><td>-1.076690</td><td>bar</td></tr><tr><th>98</th><td>2.074288</td><td>baz</td></tr><tr><th>99</th><td>-1.176129</td><td>baz</td></tr></tbody></table><p>100 rows × 2 columns</p></div><p>Or we could use ranges, for instance:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>df<span style=font-weight:700>.</span>drop(columns<span style=font-weight:700>=</span>df<span style=font-weight:700>.</span>columns[<span style=color:#099>0</span>:<span style=color:#099>2</span>])
</span></span></code></pre></div><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}<pre><code>.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</code></pre><p></style></p><table border=1 class=dataframe><thead><tr style=text-align:right><th></th><th>third</th></tr></thead><tbody><tr><th>0</th><td>baz</td></tr><tr><th>1</th><td>foo</td></tr><tr><th>2</th><td>bar</td></tr><tr><th>3</th><td>foo</td></tr><tr><th>4</th><td>foo</td></tr><tr><th>...</th><td>...</td></tr><tr><th>95</th><td>foo</td></tr><tr><th>96</th><td>foo</td></tr><tr><th>97</th><td>bar</td></tr><tr><th>98</th><td>baz</td></tr><tr><th>99</th><td>baz</td></tr></tbody></table><p>100 rows × 1 columns</p></div><h2 id=subsetting-and-indexing x-intersect="currentHeading = '#subsetting-and-indexing'">Subsetting and indexing</h2><h3 id=indexing-performance x-intersect="currentHeading = '#indexing-performance'">Indexing performance</h3><p>Let&rsquo;s assume the case where you have a column <code>BOOL</code> with values <code>Y</code> or <code>N</code> that you want to replace with an integer <code>1</code> or <code>0</code> value. The inital<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> instinct would be to do something like:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>df[<span style=color:#b84>&#34;BOOL&#34;</span>] <span style=font-weight:700>=</span> df[<span style=color:#b84>&#34;BOOL&#34;</span>]<span style=font-weight:700>.</span>eq(<span style=color:#b84>&#34;Y&#34;</span>)<span style=font-weight:700>.</span>mul(<span style=color:#099>1</span>)
</span></span></code></pre></div><p>This will result in the warning</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>SettingWithCopyWarning:
</span></span><span style=display:flex><span>A value is trying to be set on a copy of a slice from a DataFrame.
</span></span><span style=display:flex><span>Try using .loc[row_indexer,col_indexer] = value instead
</span></span></code></pre></div><p><a href=https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy>Pandas documentation</a> recommends the usage of the following idiom, since it can be considerably faster:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>df<span style=font-weight:700>.</span>loc[:, (<span style=color:#b84>&#34;BOOL&#34;</span>)] <span style=font-weight:700>=</span> df<span style=font-weight:700>.</span>loc[:, (<span style=color:#b84>&#34;BOOL&#34;</span>)]<span style=font-weight:700>.</span>eq(<span style=color:#b84>&#34;Y&#34;</span>)<span style=font-weight:700>.</span>mul(<span style=color:#099>1</span>)
</span></span></code></pre></div><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>and Pythonic?&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div></article><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=https://ruivieira.dev/>Home</a></li><li><a href=https://ruivieira.dev/blog/>Blog</a></li><li><a href=https://ruivieira.dev/draw/>Drawings</a></li><li><a href=https://ruivieira.dev/map/>All pages</a></li><li><a href=https://ruivieira.dev/search.html>Search</a></li></ul></div><div id=toc-footer style=display:none><nav id=TableOfContents><ul><li><a href=#creating-dataframes>Creating dataframes</a><ul><li><a href=#loading-from-csv>Loading from CSV</a></li><li><a href=#random-dataframes>Random dataframes</a></li></ul></li><li><a href=#concatenate-dataframes>Concatenate dataframes</a><ul><li><a href=#row-wise>Row-wise</a></li></ul></li><li><a href=#column-operations>Column operations</a><ul><li><a href=#check-column-existence>Check column existence</a></li><li><a href=#renaming-columns>Renaming columns</a></li><li><a href=#dropping-columns>Dropping columns</a></li></ul></li><li><a href=#subsetting-and-indexing>Subsetting and indexing</a><ul><li><a href=#indexing-performance>Indexing performance</a></li></ul></li></ul></nav></div><div id=share-footer style=display:none></div><div id=actions-footer><a id=menu-toggle class=icon href=# onclick='return $("#nav-footer").toggle(),!1' aria-label=Menu><i class="fas fa-bars fa-lg" aria-hidden=true></i> Menu</a>
<a id=toc-toggle class=icon href=# onclick='return $("#toc-footer").toggle(),!1' aria-label=TOC><i class="fas fa-list fa-lg" aria-hidden=true></i> TOC</a>
<a id=share-toggle class=icon href=# onclick='return $("#share-footer").toggle(),!1' aria-label=Share><i class="fas fa-share-alt fa-lg" aria-hidden=true></i> share</a>
<a id=top style=display:none class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i> Top</a></div></div></div><footer id=footer><div class=footer-left>Copyright &copy; 2024 Rui Vieira</div><div class=footer-right><nav><ul><li><a href=https://ruivieira.dev/>Home</a></li><li><a href=https://ruivieira.dev/blog/>Blog</a></li><li><a href=https://ruivieira.dev/draw/>Drawings</a></li><li><a href=https://ruivieira.dev/map/>All pages</a></li><li><a href=https://ruivieira.dev/search.html>Search</a></li></ul></nav></div></footer></div></body><link rel=stylesheet href=https://ruivieira.dev/css/fa.min.css><script src=https://ruivieira.dev/js/jquery-3.6.0.min.js></script><script src=https://ruivieira.dev/js/mark.min.js></script><script src=https://ruivieira.dev/js/main.js></script></html>