<!doctype html><html lang=en-uk><head><script data-goatcounter=https://ruivieira-dev.goatcounter.com/count async src=//gc.zgo.at/count.js></script>
<script src=https://unpkg.com/@alpinejs/intersect@3.x.x/dist/cdn.min.js></script>
<script src=https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js></script>
<script type=module src=https://ruivieira.dev/js/deeplinks/deeplinks.js></script>
<link rel=preload href=https://ruivieira.dev/lib/fonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=https://ruivieira.dev/lib/fonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=https://ruivieira.dev/lib/fonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=https://ruivieira.dev/fonts/firacode/FiraCode-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=https://ruivieira.dev/fonts/vollkorn/Vollkorn-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=stylesheet href=https://ruivieira.dev/css/kbd.css type=text/css><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Python Abstract classes Â· Rui Vieira</title><link rel=canonical href=https://ruivieira.dev/python-abstract-classes.html><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:title" content="Python Abstract classes"><meta property="og:description" content="Abstract classes were added to Python with PEP-31191. One of the goals was to add interfaces to reinforce type checking. For instance:
from abc import ABC, abstractmethod class AbstractFoo(ABC): @abstractmethod def calculate_foo(self): pass def foo(self): return self.calculate_foo() Sub-class hooksThe Abstract class implementation in Python has have a way of determinining what is a child of it even if it&rsquo;s not a direct subclass of it. This is done by using sub-class hooks."><meta property="og:type" content="article"><meta property="og:url" content="https://ruivieira.dev/python-abstract-classes.html"><meta property="article:section" content="posts"><meta property="article:modified_time" content="2023-09-02T17:28:34+01:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Python Abstract classes"><meta name=twitter:description content="Abstract classes were added to Python with PEP-31191. One of the goals was to add interfaces to reinforce type checking. For instance:
from abc import ABC, abstractmethod class AbstractFoo(ABC): @abstractmethod def calculate_foo(self): pass def foo(self): return self.calculate_foo() Sub-class hooksThe Abstract class implementation in Python has have a way of determinining what is a child of it even if it&rsquo;s not a direct subclass of it. This is done by using sub-class hooks."><link rel=stylesheet href=https://ruivieira.dev/css/styles.css><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script>
<script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://ruivieira.dev/images/favicon.ico></head><body class="max-width mx-auto px3 ltr" x-data="{currentHeading: undefined}"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-eye fa-lg"></i></a>
<a id=menu-icon-tablet href=#><i class="fas fa-eye fa-lg"></i></a>
<a id=top-icon-tablet href=# onclick='$("html, body").animate({scrollTop:0},"fast")' style=display:none aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
<span id=menu><span id=nav><ul><li><a href=https://ruivieira.dev/>Home</a></li><li><a href=https://ruivieira.dev/blog/>Blog</a></li><li><a href=https://ruivieira.dev/draw/>Drawings</a></li><li><a href=https://ruivieira.dev/map/>All pages</a></li><li><a href=https://ruivieira.dev/search.html>Search</a></li></ul></span><br><div id=share style=display:none></div><div id=toc><h4>Contents</h4><nav id=TableOfContents><ul><li><a href=#sub-class-hooks :class="{'toc-h2':true, 'toc-highlight': currentHeading == '#sub-class-hooks' }">Sub-class hooks</a></li></ul></nav><h4>Related</h4><nav><ul><li class="header-post toc"><span class=backlink-count>1</span>
<a href=https://ruivieira.dev/python-monkey-patching-for-readability.html>Python monkey patching (for readability)</a></li><li class="header-post toc"><span class=backlink-count>1</span>
<a href=https://ruivieira.dev/python.html>Python</a></li></ul></nav></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">Python Abstract classes</h1><div class=meta><div class=postdate>Updated <time datetime="2023-09-02 17:28:34 +0100 BST" itemprop=datePublished>2023-09-02</time>
<span class=commit-hash>(<a href=https://ruivieira.dev/log/index.html#d64c4a5>d64c4a5</a>)</span></div></div></header><div class=content itemprop=articleBody><p>Abstract classes were added to <a href=https://ruivieira.dev/python.html>Python</a> with PEP-3119<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>.
One of the goals was to add interfaces to reinforce type checking. For instance:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=font-weight:700>from</span> <span style=color:#555>abc</span> <span style=font-weight:700>import</span> ABC, abstractmethod
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=font-weight:700>class</span> <span style=color:#458;font-weight:700>AbstractFoo</span>(ABC):
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    @abstractmethod
</span></span><span style=display:flex><span>    <span style=font-weight:700>def</span> <span style=color:#900;font-weight:700>calculate_foo</span>(self):
</span></span><span style=display:flex><span>        <span style=font-weight:700>pass</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=font-weight:700>def</span> <span style=color:#900;font-weight:700>foo</span>(self):
</span></span><span style=display:flex><span>        <span style=font-weight:700>return</span> self<span style=font-weight:700>.</span>calculate_foo()
</span></span></code></pre></div><h2 id=sub-class-hooks x-intersect="currentHeading = '#sub-class-hooks'">Sub-class hooks</h2><p>The Abstract class implementation in Python has have a way of determinining <em>what is</em> a child of it even if it&rsquo;s not a direct subclass of it.
This is done by using <em>sub-class hooks</em>. For instance:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=font-weight:700>class</span> <span style=color:#458;font-weight:700>AbstractFoo</span>(ABC):
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    @abstractmethod
</span></span><span style=display:flex><span>    <span style=font-weight:700>def</span> <span style=color:#900;font-weight:700>calculate_foo</span>(self):
</span></span><span style=display:flex><span>        <span style=font-weight:700>pass</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=font-weight:700>def</span> <span style=color:#900;font-weight:700>foo</span>(self):
</span></span><span style=display:flex><span>        <span style=font-weight:700>return</span> self<span style=font-weight:700>.</span>calculate_foo()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    @classmethod
</span></span><span style=display:flex><span>    <span style=font-weight:700>def</span> <span style=color:#900;font-weight:700>__subclasshook__</span>(cls, C):
</span></span><span style=display:flex><span>        <span style=font-weight:700>return</span> <span style=color:#999>hasattr</span>(C, <span style=color:#b84>&#34;calculate_foo&#34;</span>)
</span></span></code></pre></div><p>will return <code>True</code> if a class implements <code>calculate_foo</code>, even if it&rsquo;s not a sub-class of <code>AbstractFoo</code>.
For instance:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=font-weight:700>class</span> <span style=color:#458;font-weight:700>NotAFoo</span>:
</span></span><span style=display:flex><span>    <span style=font-weight:700>def</span> <span style=color:#900;font-weight:700>calculate_foo</span>(self):
</span></span><span style=display:flex><span>        <span style=color:#999>print</span>(<span style=color:#b84>&#34;I can calculate Foo!&#34;</span>)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span><span style=color:#999>isinstance</span>(NotAFoo(), AbstractFoo)
</span></span></code></pre></div><pre><code>True
</code></pre><p>Since <code>__subclasshook__</code> can contain any code that can be evaluated at runtime, we can get creative.
For instance, we can create an abstract class for classes that have names like 1960s Frank Zappa albums.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=font-weight:700>class</span> <span style=color:#458;font-weight:700>SixtiesZappa</span>(ABC):
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    @classmethod
</span></span><span style=display:flex><span>    <span style=font-weight:700>def</span> <span style=color:#900;font-weight:700>__subclasshook__</span>(cls, C):
</span></span><span style=display:flex><span>        albums <span style=font-weight:700>=</span> [album<span style=font-weight:700>.</span>title()<span style=font-weight:700>.</span>replace(<span style=color:#b84>&#34; &#34;</span>, <span style=color:#b84>&#34;&#34;</span>) <span style=font-weight:700>for</span> album <span style=font-weight:700>in</span> 
</span></span><span style=display:flex><span>                  [<span style=color:#b84>&#34;Freak Out&#34;</span>, <span style=color:#b84>&#34;Absolutely Free&#34;</span>, <span style=color:#b84>&#34;Lumpy Gravy&#34;</span>, <span style=color:#b84>&#34;We&#39;re Only in It for the Money&#34;</span>, <span style=color:#b84>&#34;Cruising with Ruben &amp; the Jets&#34;</span>, <span style=color:#b84>&#34;Mothermania&#34;</span>, <span style=color:#b84>&#34;Uncle Meat&#34;</span>, <span style=color:#b84>&#34;Hot Rats&#34;</span>]]
</span></span><span style=display:flex><span>        name <span style=font-weight:700>=</span> C<span style=font-weight:700>.</span>__name__
</span></span><span style=display:flex><span>        <span style=font-weight:700>return</span> name <span style=font-weight:700>in</span> albums
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=font-weight:700>class</span> <span style=color:#458;font-weight:700>HotRats</span>:
</span></span><span style=display:flex><span>    <span style=font-weight:700>pass</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#999>isinstance</span>(HotRats(), SixtiesZappa)
</span></span></code></pre></div><pre><code>True
</code></pre><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=font-weight:700>class</span> <span style=color:#458;font-weight:700>WeaselsRippedMyFlesh</span>:
</span></span><span style=display:flex><span>    <span style=font-weight:700>pass</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#999>isinstance</span>(WeaselsRippedMyFlesh(), SixtiesZappa)
</span></span></code></pre></div><pre><code>False
</code></pre><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>PEP-3119, from 2007: <a href=https://peps.python.org/pep-3119/>https://peps.python.org/pep-3119/</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div></article><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=https://ruivieira.dev/>Home</a></li><li><a href=https://ruivieira.dev/blog/>Blog</a></li><li><a href=https://ruivieira.dev/draw/>Drawings</a></li><li><a href=https://ruivieira.dev/map/>All pages</a></li><li><a href=https://ruivieira.dev/search.html>Search</a></li></ul></div><div id=toc-footer style=display:none><nav id=TableOfContents><ul><li><a href=#sub-class-hooks>Sub-class hooks</a></li></ul></nav></div><div id=share-footer style=display:none></div><div id=actions-footer><a id=menu-toggle class=icon href=# onclick='return $("#nav-footer").toggle(),!1' aria-label=Menu><i class="fas fa-bars fa-lg" aria-hidden=true></i> Menu</a>
<a id=toc-toggle class=icon href=# onclick='return $("#toc-footer").toggle(),!1' aria-label=TOC><i class="fas fa-list fa-lg" aria-hidden=true></i> TOC</a>
<a id=share-toggle class=icon href=# onclick='return $("#share-footer").toggle(),!1' aria-label=Share><i class="fas fa-share-alt fa-lg" aria-hidden=true></i> share</a>
<a id=top style=display:none class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i> Top</a></div></div></div><footer id=footer><div class=footer-left>Copyright &copy; 2023 Rui Vieira</div><div class=footer-right><nav><ul><li><a href=https://ruivieira.dev/>Home</a></li><li><a href=https://ruivieira.dev/blog/>Blog</a></li><li><a href=https://ruivieira.dev/draw/>Drawings</a></li><li><a href=https://ruivieira.dev/map/>All pages</a></li><li><a href=https://ruivieira.dev/search.html>Search</a></li></ul></nav></div></footer></div></body><link rel=stylesheet href=https://ruivieira.dev/css/fa.min.css><script src=https://ruivieira.dev/js/jquery-3.6.0.min.js></script>
<script src=https://ruivieira.dev/js/mark.min.js></script>
<script src=https://ruivieira.dev/js/main.js></script></html>