<!doctype html><html lang=en-uk><head><script data-goatcounter=https://ruivieira-dev.goatcounter.com/count async src=//gc.zgo.at/count.js></script>
<script type=module src=/js/deeplinks/deeplinks.js></script>
<link rel=preload href=/lib/fonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/fonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/fonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/fonts/firacode/FiraCode-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/fonts/prociono/Prociono-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=stylesheet href=/css/kbd.css type=text/css><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Spearman correlation · Rui Vieira</title><link rel=canonical href=/spearman-correlation.html><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:title" content="Spearman correlation"><meta property="og:description" content="Spearman rank correlation The Spearman correlation coefficient (or Spearman&rsquo;s $\rho$) measures rank correlation between two variables. It is used to detect the existence of monotonic relationship between variables.
Assuming monotonicity, the Spearman&rsquo;s $\rho$ will take values between $-1$ and $1$, representing completely opposite or identical ranks, respectively1, or, in other words, a negative monotonic relationship or a positive one.
Due to the dependance on ranks, the Spearman&rsquo;s $\rho$ is used for ordinal value, although discrete and continous values are possible."><meta property="og:type" content="article"><meta property="og:url" content="/spearman-correlation.html"><meta property="article:section" content="posts"><meta property="article:modified_time" content="2022-08-09T20:58:16+01:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Spearman correlation"><meta name=twitter:description content="Spearman rank correlation The Spearman correlation coefficient (or Spearman&rsquo;s $\rho$) measures rank correlation between two variables. It is used to detect the existence of monotonic relationship between variables.
Assuming monotonicity, the Spearman&rsquo;s $\rho$ will take values between $-1$ and $1$, representing completely opposite or identical ranks, respectively1, or, in other words, a negative monotonic relationship or a positive one.
Due to the dependance on ranks, the Spearman&rsquo;s $\rho$ is used for ordinal value, although discrete and continous values are possible."><link rel=stylesheet href=/css/styles.css><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script>
<script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=images/favicon.ico></head><body class="max-width mx-auto px3 ltr"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-eye fa-lg"></i></a>
<a id=menu-icon-tablet href=#><i class="fas fa-eye fa-lg"></i></a>
<a id=top-icon-tablet href=# onclick='$("html, body").animate({scrollTop:0},"fast")' style=display:none aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
<span id=menu><span id=nav><ul><li><a href=/>Home</a></li><li><a href=/map/>All pages</a></li><li><a href=/search.html>Search</a></li></ul></span><br><div id=share style=display:none></div><div id=toc><h4>Contents</h4><nav id=TableOfContents><ul><li><a href=#spearman-rank-correlation>Spearman rank correlation</a></li><li><a href=#example>Example</a></li></ul></nav><h4>Related</h4><nav><ul><li class="header-post toc"><span class=backlink-count>1</span>
<a href=/statistical-dependence.html>Statistical dependence</a></li></ul></nav></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">Spearman correlation</h1><div class=meta><div class=postdate>Updated <time datetime="2022-08-09 20:58:16 +0100 BST" itemprop=datePublished>2022-08-09</time>
<span class=commit-hash>(<a href=/log/index.html#2985df0>2985df0</a>)</span></div></div></header><div class=content itemprop=articleBody><h2 id=spearman-rank-correlation>Spearman rank correlation</h2><p>The Spearman correlation coefficient (or Spearman&rsquo;s $\rho$) measures rank correlation between two variables. It is used to detect the existence of monotonic relationship between variables.</p><p>Assuming monotonicity, the Spearman&rsquo;s $\rho$ will take values between $-1$ and $1$, representing completely opposite or identical ranks, respectively<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>, or, in other words, a negative monotonic relationship or a positive one.</p><p>Due to the dependance on ranks, the Spearman&rsquo;s $\rho$ is used for ordinal value, although discrete and continous values are possible.</p><p>If we consider a dataset of size $n$, and $X_i, Y_i$ as the scores, we can
then calculate the ranks as $\operatorname{R}({X_i}), \operatorname{R}({Y_i})$, and $\rho$ as</p><p>$$
r_s = \rho_{\operatorname{R}(X),\operatorname{R}(Y)} = \frac{\operatorname{cov}(\operatorname{R}(X), \operatorname{R}(Y))} {\sigma_{\operatorname{R}(X)} \sigma_{\operatorname{R}(Y)}},
$$</p><p>Here $\rho$ is the Pearson correlation coefficient, but applied to the rank variables, $\operatorname{cov}(\operatorname{R}(X), \operatorname{R}(Y))cov(R(X),R(Y))$ is the covariance of the rank variables, $\sigma_{\operatorname{R}(X)}$ and $\sigma_{\operatorname{R}(Y)}$ are the standard deviations of the rank variables.</p><p>If all the ranks are distinct integers, the simplified form can be applied</p><p>$$
r_s = 1 - \frac{6 \sum d_i^2}{n(n^2 - 1)},
$$</p><p>where $d_i = \operatorname{R}(X_i) - \operatorname{R}(Y_i)$ is the difference between the two ranks of each observation, $n$ is the number of observations.</p><p>The Spearman rank correlation test can be used when</p><ul><li>The variables are quantitative or ordinal</li><li>Variables do not meet normality assumption</li><li>Variables have a monotonic relationship</li></ul><h2 id=example>Example</h2><p>For the example we will use the scipy implementation and the iris dataset.</p><pre tabindex=0><code class=language-coconut data-lang=coconut>from sklearn import datasets
import pandas as pd
import scipy

# create ordinal categories
def categorize_petal_len(x):
    if x &lt;= 1.6:
        return &#39;LOW&#39;
    elif x &lt;= 5.1:
        return &#39;AVERAGE&#39;
    else:
        return &#39;HIGH&#39;


iris = datasets.load_iris() 
df = iris |&gt; .data |&gt; pd.DataFrame
df[&#34;class&#34;] = iris.target
df.columns = [&#39;sepal_len&#39;, &#39;sepal_wid&#39;, &#39;petal_len&#39;, &#39;petal_wid&#39;, &#39;class&#39;]
df.dropna(how=&#34;all&#34;, inplace=True)
df[&#39;petal_len_cats&#39;] = df[&#39;petal_len&#39;].apply(categorize_petal_len)
df
</code></pre><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}<pre><code>.dataframe tbody tr th{vertical-align:top}.dataframe thead th{text-align:right}</code></pre><p></style></p><table border=1 class=dataframe><thead><tr style=text-align:right><th></th><th>sepal_len</th><th>sepal_wid</th><th>petal_len</th><th>petal_wid</th><th>class</th><th>petal_len_cats</th></tr></thead><tbody><tr><th>0</th><td>5.1</td><td>3.5</td><td>1.4</td><td>0.2</td><td>0</td><td>LOW</td></tr><tr><th>1</th><td>4.9</td><td>3.0</td><td>1.4</td><td>0.2</td><td>0</td><td>LOW</td></tr><tr><th>2</th><td>4.7</td><td>3.2</td><td>1.3</td><td>0.2</td><td>0</td><td>LOW</td></tr><tr><th>3</th><td>4.6</td><td>3.1</td><td>1.5</td><td>0.2</td><td>0</td><td>LOW</td></tr><tr><th>4</th><td>5.0</td><td>3.6</td><td>1.4</td><td>0.2</td><td>0</td><td>LOW</td></tr><tr><th>...</th><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr><tr><th>145</th><td>6.7</td><td>3.0</td><td>5.2</td><td>2.3</td><td>2</td><td>HIGH</td></tr><tr><th>146</th><td>6.3</td><td>2.5</td><td>5.0</td><td>1.9</td><td>2</td><td>AVERAGE</td></tr><tr><th>147</th><td>6.5</td><td>3.0</td><td>5.2</td><td>2.0</td><td>2</td><td>HIGH</td></tr><tr><th>148</th><td>6.2</td><td>3.4</td><td>5.4</td><td>2.3</td><td>2</td><td>HIGH</td></tr><tr><th>149</th><td>5.9</td><td>3.0</td><td>5.1</td><td>1.8</td><td>2</td><td>AVERAGE</td></tr></tbody></table><p>150 rows × 6 columns</p></div><pre tabindex=0><code class=language-coconut data-lang=coconut>from scipy.stats import spearmanr

sp = (X, Y) -&gt; spearmanr(df[X], df[Y])

correlation, p_value = sp(&#39;sepal_len&#39;, &#39;sepal_wid&#39;)

f&#34;correlation = {correlation}, p-value = {p_value}&#34; |&gt; print
</code></pre><pre><code>correlation = -0.166777658283235, p-value = 0.04136799424884587
</code></pre><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>Assuming no repeated ranks.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div></article><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=/>Home</a></li><li><a href=/map/>All pages</a></li><li><a href=/search.html>Search</a></li></ul></div><div id=toc-footer style=display:none><nav id=TableOfContents><ul><li><a href=#spearman-rank-correlation>Spearman rank correlation</a></li><li><a href=#example>Example</a></li></ul></nav></div><div id=share-footer style=display:none></div><div id=actions-footer><a id=menu-toggle class=icon href=# onclick='return $("#nav-footer").toggle(),!1' aria-label=Menu><i class="fas fa-bars fa-lg" aria-hidden=true></i> Menu</a>
<a id=toc-toggle class=icon href=# onclick='return $("#toc-footer").toggle(),!1' aria-label=TOC><i class="fas fa-list fa-lg" aria-hidden=true></i> TOC</a>
<a id=share-toggle class=icon href=# onclick='return $("#share-footer").toggle(),!1' aria-label=Share><i class="fas fa-share-alt fa-lg" aria-hidden=true></i> share</a>
<a id=top style=display:none class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i> Top</a></div></div></div><footer id=footer><div class=footer-left>Copyright &copy; 2022 Rui Vieira</div><div class=footer-right><nav><ul><li><a href=/>Home</a></li><li><a href=/map/>All pages</a></li><li><a href=/search.html>Search</a></li></ul></nav></div></footer></div></body><link rel=stylesheet href=/css/fa.min.css><script src=/js/jquery-3.6.0.min.js></script>
<script src=/js/mark.min.js></script>
<script src=/js/main.js></script>
<script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]]},svg:{fontCache:"global"}}</script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></html>